syntax = "proto3";

package datapb;

import "google/api/annotations.proto";

enum Scope {
    Public = 0;
    Personal = 1;
    ContextRestricted = 2;
}

message AttributeDefinition {
    string id = 1;
    string label = 2;
    string mime = 3;
    string description = 4;
    bool unique = 5;
    Scope scope = 6;
}

message Attribute {
    string id = 1;
    string context = 2;
    string mime = 3;
    string uri = 4;
}


service DataStore {
    rpc SetAttributes(SetAttributesRequest) returns (SetAttributesResponse) {
        option(google.api.http) = {
            post: "/data/save";
            body: "*";
        };
    };
    rpc GetAttributes(GetAttributesRequest) returns (GetAttributesResponse) {
        option(google.api.http) = {
            post: "/data";
            body: "*";
        };
    };
}

message SetAttributesRequest {
    string subject = 1;
    repeated Attribute attributes = 2;
}
message SetAttributesResponse {}

message GetAttributesRequest {
    string subject = 1;
    map<string, string> contextual_attribute_ids = 2;
}
message GetAttributesResponse {
    map<string, Attribute> attributes = 1;
}